# Часть 27

 В этой части, мы будем решать упражнение, которое мы оставили для решения в предыдущей части. Оно называется **IDA\_STRUCT.7Z**. Если Вы не решили это упражнение или у Вас его нет, загрузите его отсюда.  
  
[http://ricardo.crver.net/WEB/INTRODUCCION AL REVERSING CON IDA PRO DESDE CERO/EJERCICIOS/IDA\_STRUCT\_RESOLVER DESPUES DE LA PARTE 26.7z](http://ricardo.crver.net/WEB/INTRODUCCION%20AL%20REVERSING%20CON%20IDA%20PRO%20DESDE%20CERO/EJERCICIOS/IDA_STRUCT_RESOLVER%20DESPUES%20DE%20LA%20PARTE%2026.7z)  
  
Исполняемый файл называется **CONSOLEAPPLICATION4.EXE** и в том же каталоге находятся символы **CONSOLEAPPLICATION4.PDB.**  
  
Когда **IDA** загрузит файл, то сообщит Вам, что она пытается найти символы. Вы можете указать на этот файл и загрузить символы, с которыми программу станет немного яснее понимать. Но для нашего примера, я буду удалять или переименовывать файл **PDB**, чтобы загрузить программу без символов, что соответствует тому, с чем мы обычно имеем дело. Хотя это и выглядит сложнее, зато приближено к реальности.  
  
![1.png](https://wasm.in/attachments/1-png.2169/)   
  
Очевидно, что без символов, функция не будет определяться как **MAIN**. Мы можем добраться до неё, так как это консольное приложение, которое ищет аргументы **ARGV** или **ARGC**, а если их нет**,** то её, обычно, можно найти через поиск строк.  
  
Если мы запустим программу, то увидим, что первое, что она сделает - это попросит нас ввести число. Здесь Вы видите строки, которые могут быть хорошим и плохим сообщением.  
  
![2.png](https://wasm.in/attachments/2-png.2170/)   
  
Щелкните на строке **PLEASE ENTER YOUR NUMBER OF CHOICE:**  
  
![3.png](https://wasm.in/attachments/3-png.2171/)   
  
Мы видим, что строка имеет ссылки. Помещая курсор над стрелкой или нажимая клавишу **X** на адресе, мы видим, что строка имеет ссылку.  
  
![4.png](https://wasm.in/attachments/4-png.2172/)   
  
![5.png](https://wasm.in/attachments/5-png.2173/)   
  
Давайте перейдём по этому адресу.  
  
![6.png](https://wasm.in/attachments/6-png.2174/)   
  
Видим, что мы находимся внутри функции. Далее видно вывод строки и вызов функции для печати этой строки. Поскольку у нас нет символом, **IDA** не говорит нам, что функция по адресу **0x401220** - это функция **PRINTF**. Если мы посмотрим во внутрь этой функции.  
  
![7.png](https://wasm.in/attachments/7-png.2175/)   
  
Вы можете посмотреть во внутрь этой функции и увидеть, что внутри есть ещё несколько функций.  
  
![8.png](https://wasm.in/attachments/8-png.2176/)   
  
![9.png](https://wasm.in/attachments/9-png.2177/)   
  
В **PROXIMITY** **VIEW**, в который можно войти нажав клавишу **-** и выйти, нажав **+,** мы видим, что функция **0x401220** вызывает те же самые три функции, но две функции **0x401000** и **ACRT\_IOB\_FUNC** - это функции, которые что-то делают и возвращаются назад. Они не идут к другим дочерним функциям.  
  
![10.png](https://wasm.in/attachments/10-png.2178/)   
  
Здесь, где есть стрелки, которые я добавил, видно, что блоки не идут к другим функциям. Только одна функция, которая вызывает другие функции - это функция по адресу **0x4010F0**, которая вызывает две функции и первая из вызываемых, это функция **VFPRINTF.** Функция после своего выполнения возвращается обратно и ниже уже нет никаких других функций.  
  
Это также можно увидеть в дизассемблерном списке. Если я посмотрю во внутрь каждой функции, я увижу то же самое.  
  
Видно, что функция **0x401000** никуда не ведёт. Функция просто исполняет ерунду и возвращает выполнение.  
  
![11.png](https://wasm.in/attachments/11-png.2179/)   
  
![12.png](https://wasm.in/attachments/12-png.2180/)   
  
И **\_ACRT\_IOB\_FUNC** - это **API** функция. Поэтому функция не будет продолжаться??? Функция будет только инициализировать поток **STDOUT**, чтобы затем быть готовой печатать текст.  
  
![13.png](https://wasm.in/attachments/13-png.2181/)   
  
Другими словам, передача аргумента **1**, как в нашем случае, будет инициализировать поток **STDOUT**.  
  
![14.png](https://wasm.in/attachments/14-png.2182/)   
  
И третья функция, которая будет вызываться, это функция по адресу **4010F0**.  
  
![15.png](https://wasm.in/attachments/15-png.2183/)   
  
Функция заканчивается вызовом **VFPRINTF**, т.е. мы пришли к тому же, что видно и в **PROXIMITY** **VIEW**, но это занимает больше времени.  
  
![16.png](https://wasm.in/attachments/16-png.2184/)   
  
Так что давайте переименуем функцию по адресу **0x401220** в **PRINTF**.  
  
![17.png](https://wasm.in/attachments/17-png.2185/)   
  
Те блоки, которые заканчиваются вызовом **API**, как в этом случае **PRINTF**, я буду закрашивать в небесный цвет. Каждый будет делать это по своему вкусу.  
  
![18.png](https://wasm.in/attachments/18-png.2186/)   
  
Следующая функция по адресу **0x40109D** – это конечно же функция **SCANF**. Если мы перейдём в неё и посмотрим в **PROXIMITY** **VIEW**, то увидим:  
  
![19.png](https://wasm.in/attachments/19-png.2187/)   
  
Здесь я нажимаю на **+,** чтобы увидеть спрятанные блоки.  
  
![20.png](https://wasm.in/attachments/20-png.2188/)   
  
Мы видим, что это функция **SCANF**.  
  
![21.png](https://wasm.in/attachments/21-png.2189/)   
  
И в этом случае, функция **\_ACRT\_IOB\_FUNC** с аргументом **0** инициализирует поток **STDIN**.  
  
![22.png](https://wasm.in/attachments/22-png.2190/)   
  
Поэтому, мы переименовываем эту функцию в **SCANF**.  
  
![23.png](https://wasm.in/attachments/23-png.2191/)   
  
![24.png](https://wasm.in/attachments/24-png.2192/)   
  
Мы видим что-то похожее на структуру, потому что когда Вы передаёте адрес как аргумент и затем извлекаете его и прибавляете к нему смещение для доступа к полям в каждом месте, в котором они используются, возможно это является адресом структуры.  
  
Давайте посмотрим на ссылки для следующую функции.  
  
![25.png](https://wasm.in/attachments/25-png.2193/)   
  
Мы видим, что есть две ссылки. Если я зайду в первую.  
  
![26.png](https://wasm.in/attachments/26-png.2194/)   
  
Я вижу, что аргумент в обоих случаях является адресом, который даёт представление о структурах.  
  
Поскольку два разных адреса производят впечатление, что они были двумя структурами одного и того же типа, мы начнем создавать единую структуру, не зная размера, не зная полей или чего-то еще. Мы будем понемногу реверсить её внутреннюю структуру.  
  
Мы видим, что максимальное смещение, которое я нахожу до настоящего времени равно **0x14.** Поэтому я буду создавать структуру этой длины. Если структура станет больше, я буду увеличивать её размер.  
  
![27.png](https://wasm.in/attachments/27-png.2195/)   
  
Для этого, я иду во вкладку **STRUCTURES**. Это один из способов её создания. Другой способ - это перейти в **LOCAL** **TYPES** и создать её как код в стиле **C**. Давайте так и сделаем.  
  
Это немного раздражает и это не очень интуитивно. Но хорошо когда мы находимся в месте где определена структура. Здесь мы можем сделать **CREATE** **STRUCT** **FROM** **SELECTION**. Обычно мы будем создавать структуру в некоторой функции где она не определена, ничего не зная о ней.  
  
Я знаю, что если проанализировать представление стека функции **MAIN**, я мог бы здесь использовать опцию **CREATE** **STRUCT** **FROM** **SELECTION** и это облегчило бы мне жизнь, но давайте возьмём наихудший случай. Представим, что мы находимся в функции очень большой программы и что мы далеко от того места, где она была определена, так что мы должны исправить их как только можем.  
  
![28.png](https://wasm.in/attachments/28-png.2196/)   
  
Здесь мы видим, что для создания структуры Вы должны нажать клавишу **INS.** Сделаем же это.  
  
![29.png](https://wasm.in/attachments/29-png.2197/)   
  
Я могу назначить имя, какое захочу. Назовём нашу структуру **MYSTRUCT**.  
  
![30.png](https://wasm.in/attachments/30-png.2198/)   
  
Здесь она была создана мной с размером **0**. Сейчас я буду делать трюк. Когда я всё ещё не знаю полей или чего-то ещё и я хочу дать полю размер, сначала я нажимаю **D** на слове **ENDS**, чтобы добавить одно поле.  
  
![31.png](https://wasm.in/attachments/31-png.2199/)   
  
Здесь я добавляю поле длиной **1** байт **DB**. Если бы я снова нажал **D**, я бы переключился на слово **DW** и затем на **DD**.  
  
Но здесь, поскольку мы не знаем, что нам нужно, мы оставляем всё так и делаем правый щелчок на структуре.  
  
![32.png](https://wasm.in/attachments/32-png.2200/)   
  
Так как я видел поле со смещением **0x14**.  
  
![33.png](https://wasm.in/attachments/33-png.2201/)   
  
Таким образом, чтобы заполнить это поле с помощью **DWORD**, структуре нужно ещё **4** байта, поэтому я буду создавать структуру из **0x18** байт**.** Я буду добавлять ещё **0x17** байт к байту, который был у структуры.  
  
![34.png](https://wasm.in/attachments/34-png.2202/)   
  
![35.png](https://wasm.in/attachments/35-png.2203/)   
  
Я вижу, что размер стал равен **0x18**. Теперь мы оставим структуру такой.  
  
Поскольку эта функция вызывается дважды, первый раз с адресом первой структуры типа **MYSTRUCT**, которую мы будем произвольно называть **PEPE** и второй раз с адресом второй структуры того же типа **MYSTRUCT**, которую мы будем называть **JUAN.** Внутри функции, мы будем давать общее имя, которое будет обслуживать оба случая.  
  
В исходном коде, это выглядит так. Чтобы уточнить две переменные типа **MYSTRUCT** первая называется **PEPE**, а другая **JUAN**. Обе передают свой адрес как аргумент в функцию.  
  
![36.png](https://wasm.in/attachments/36-png.2204/)   
  
![37.png](https://wasm.in/attachments/37-png.2205/)   
  
  
Так как одна и та же функция сначала будет иметь адрес первой структуры или **PEPE** в аргументе **ARG0** и во второй раз, когда она будет вызвана она будет иметь адрес структуры **JUAN**, то я буду давать структуре общее имя для обоих случаев, например \_**STRUCT**.  
  
Если я декомпилирую функцию с помощью **F5**, я вижу, что результат неверный.  
  
![38.png](https://wasm.in/attachments/38-png.2206/)   
  
Я вижу, что определение переменной является простым типом **INT**, а не как в исходном коде как адрес структуры. Я могу это исправить так.  
  
![39.png](https://wasm.in/attachments/39-png.2207/)   
  
Это позволяет выбрать адрес структуры, в котором она находится, и здесь мы будем выбирать тип **MYSTRUCT**.  
  
![40.png](https://wasm.in/attachments/40-png.2208/)   
  
Очевидно, что **BUF** - это **PEPE** и здесь он получает свой адрес и передаёт его как аргумент. Давайте посмотрим **BUF** в представлении стека.  
  
Поэтому структура необязательна, чтобы создать её, потому что она уже существует. Я просто должен сказать Вам, что **BUF –** это переменная типа **MYSTRUCT**. Для этого нажмите сочетание **ALT** + **Q** на переменной **BUF**.  
  
![41.png](https://wasm.in/attachments/41-png.2209/)   
  
и **IDA** назначит переменной **BUF** тип **MYSTRUCT**. Если мы поместим размер ниже, некоторые поля будут опущены, но затем можно будет увеличить структуру **MYSTRUCT** и она будет исправлена только здесь.\(Если она не сломается конечно\)  
  
![42.png](https://wasm.in/attachments/42-png.2210/)   
  
Мы переименовываем **BUF** в **PEPE**.  
  
Мы видим здесь, что адрес **PEPE** передан и во втором вызове передаётся адрес **VAR**\_**44**, которая также будет переменной **JUAN** типа **MYSTRUCT**, поэтому мы пойдём в представление стека и на переменной **VAR**\_**44** мы также нажмём **ALT** + **Q**.  
  
![43.png](https://wasm.in/attachments/43-png.2211/)   
  
У нас уже есть две структуры типа **MYSTRUCT**.  
  
Я возвращаюсь в функцию.  
  
![44.png](https://wasm.in/attachments/44-png.2212/)   
  
![45.png](https://wasm.in/attachments/45-png.2213/)   
  
Мы видим, что поле **0x10** является **DWORD** где оно передаётся функции **SCANF**, поэтому мы переходим в **MYSTRUCT** и в поле **0x10** мы нажимаем **D** до тех пор пока оно не будет иметь тип **DD**.  
  
![46.png](https://wasm.in/attachments/46-png.2214/)   
  
![47.png](https://wasm.in/attachments/47-png.2215/)   
  
Я переименую это поле в **NUMERO**.  
  
![48.png](https://wasm.in/attachments/48-png.2216/)   
  
Другая запись - это поле по смещению **0x14**, которое используется в цикле для удаления символа **0xA**. Я назову его **C**.  
  
![49.png](https://wasm.in/attachments/49-png.2217/)   
  
Давайте пойдём в поле по смещению **0x14** структуры **MYSTRUCT** и будем нажимать **D** до тех пор пока не появится **DWORD** и давайте назовём это поле именем **C**.  
  
![50.png](https://wasm.in/attachments/50-png.2218/)   
  
![51.png](https://wasm.in/attachments/51-png.2219/) 

 Здесь мы нажимаем **T**, чтобы освежить информацию.  
  
Наконец, я переименовываю функцию в **ENTER**.  
  
![1.png](https://wasm.in/attachments/1-png.2259/)   
  
Мы видим, что три первые функции вызывают **ENTER** передавая адрес **PEPE** и три следующие передают адрес **JUAN**.  
  
Давайте посмотрим на следующую функцию.  
  
![2.png](https://wasm.in/attachments/2-png.2260/)   
  
Эта функция также использует обе структуры, поэтому Вы можете равно как в предыдущем случае нажать **F5**.  
  
![3.png](https://wasm.in/attachments/3-png.2261/)   
  
Здесь на переменной **\_STRUCT** я делаю правый щелчок и выбираю пункт **CONVERT TO STRUCT \***.  
  
![4.png](https://wasm.in/attachments/4-png.2262/)   
  
Сейчас, это адрес структуры **MYSTRUCT** и, как и раньше, мы увидим поля только нажав клавишу **T** в соответствующем месте.  
  
![5.png](https://wasm.in/attachments/5-png.2263/)   
  
Здесь мы видим, что программа сравнивает поле **NUMERO**, которое мы передали, с числом **0x10** и поскольку сравнение знаковое, любое отрицательное число может пройти. Например число **0xFFFFFFFF**, которое равно **-1** и которое меньше **0x10**.  
  
![6.png](https://wasm.in/attachments/6-png.2264/)   
  
Затем, программа использует **NUMERO** как размер для функции **GETS**\_**S**, которое мы передали ей и другой аргумент. Он должен быть буфером, который находится в начале структуры, потому что он использует её начальный адрес.  
  
Я иду в **MYSTRUCT** и по смещению **0x0** нажимаю **D** один раз, чтобы создать единственное байтовое поле.  
  
![7.png](https://wasm.in/attachments/7-png.2265/)   
  
Теперь, здесь, я делаю правый щелчок и выбираю **ARRAY**.  
  
![8.png](https://wasm.in/attachments/8-png.2266/)   
  
Размер буфера будет равен **16** байт. Я соглашаюсь с этим значением.  
  
Переименовываю это поле в **BUFFER.**  
  
![9.png](https://wasm.in/attachments/9-png.2267/)   
  
Размер поля теперь равен **16** десятичных байт.  
  
Давайте продолжим реверсить.  
  
![10.png](https://wasm.in/attachments/10-png.2268/)   
  
Проблема состоит в том, что с помощью функции **GETS**\_**S** буфер может быть переполнен, так как функция **CHECK** позволяет передавать отрицательные значении при использовании в качестве размера. Они будут восприниматься как беззнаковые значения и будут очень большими.  
  
Если, например, мы передадим **0xFFFFFFFF** в сравнение, значение будет равно **-1**, потому что оно идет как знаковое и будет меньше чем **0x10**, но используя его как размер, оно будет большим положительным значением **0xFFFFFFFF**, которое позволяет нам передавать количество символом, которое мы хотим через функцию **GET**\_**S** в буфер и переполнить его.  
  
Таким образом, мы могли бы переименовать функцию в **CHECK** или **GET**. Независимо от того, что мы хотим, нужно чтобы имя отражало то, что делает функция. Мы будем проверять это соответствие.  
  
![11.png](https://wasm.in/attachments/11-png.2269/)   
  
У меня есть третья функция. Аргумент тот же, поэтому я повторяю процедуру, нажимаю **F5** и изменяю тип аргумента.  
  
![12.png](https://wasm.in/attachments/12-png.2270/)   
  
Я продолжаю реверсить.  
  
![13.png](https://wasm.in/attachments/13-png.2271/)   
  
Мы видим, что есть ещё одно поле, поскольку оно пытается сравнить значение \[**EAX**+**0x18**\], которое мы не определили, так как наше последнее поле структуры **MYSTRUCT** равно **0x14**. Давайте добавим его.  
  
![14.png](https://wasm.in/attachments/14-png.2272/)   
  
Мы помещаем указатель на слове **ENDS** и нажимаем **D** до тех пор пока не создадим новое поле **DD**.  
  
![15.png](https://wasm.in/attachments/15-png.2273/)   
  
Я переименовываю это поле в **COOKIE**.  
  
![16.png](https://wasm.in/attachments/16-png.2274/)   
  
Я возвращаюсь в нашу функцию и нажимаю **T** для обновления информации.  
  
![17.png](https://wasm.in/attachments/17-png.2275/)   
  
Мы видим, что существует ещё другое поле. Это единственный байт.  
  
![18.png](https://wasm.in/attachments/18-png.2276/)   
  
Поэтому мы возвращаемся назад в структуру **MYSTRUCT** и на слове **ENDS** нажимаем **D** один раз и у нас появляется поле из одного байта.  
  
![19.png](https://wasm.in/attachments/19-png.2277/)   
  
Я переименовываю это поле во **FLAG**, чтобы он совпадал с исходным кодом.  
  
Теперь возвращаемся в функцию.  
  
![20.png](https://wasm.in/attachments/20-png.2278/)   
  
Если переменная **COOKIE** равна **0x99989796**, тогда программа будет устанавливать флаг структуры в **1**.  
  
![21.png](https://wasm.in/attachments/21-png.2279/)   
  
Если для некоторых изменений, которые не распространялись хорошо, переменные функции **MAIN** сломаются, и мы не сделали снимок, как это случилось со мной, то делаем так.  
  
![22.png](https://wasm.in/attachments/22-png.2280/)   
  
Я иду в начало поломанной функции и нажимаю **U**.  
  
![24.png](https://wasm.in/attachments/24-png.2281/)   
  
Я соглашаюсь на вопрос программы «сломать» функцию.  
  
![25.png](https://wasm.in/attachments/25-png.2282/)   
  
Затем, там же, в начале функции, я нажимаю **C**.  
  
![26.png](https://wasm.in/attachments/26-png.2283/)   
  
И затем я делаю правый щелчок и выбираю пункт **CREATE** **FUNCTION**.  
  
![27.png](https://wasm.in/attachments/27-png.2284/)   
  
Теперь всё хорошо.  
  
Посмотрим в статическое представление стека.  
  
![28.png](https://wasm.in/attachments/28-png.2285/)   
  
Мы видим, что после каждый структуры остаются три пустых байта, потому что последнее поле было единственным байтом и больше ничего нет.  
  
Только имена структур неправильные, но я буду менять их в соответствии с исходным коде, т. е. я изменяю имена на **PEPE** и **JUAN**.  
  
![29.png](https://wasm.in/attachments/29-png.2286/)   
  
![30.png](https://wasm.in/attachments/30-png.2287/)   
  
Мы видим, что со структурой **JUAN** программа будет делать то же самое что и с **PEPE**. Структуры будут передавать свои адреса функциям **ENTER** и **CHECK**. Но программа имеет ещё третью функцию. Давайте посмотрим, что она делает.  
  
![31.png](https://wasm.in/attachments/31-png.2288/)   
  
Нажимая **T** в полях, мы видим, что функция похожа на функцию “**DESICION**”, только константа с которой сравнивается поле **COOKIE** структуры **JUAN** отличается. В этом случае константа равна **0x33343536**.  
  
Другими словами, поле **COOKIE** структуры **PEPE** должно быть равно значению **0x99989796** и поле структуры **JUAN** должно быть равно **0x33343536**. Только так флаги каждой структуры будут равны 1.  
  
![32.png](https://wasm.in/attachments/32-png.2289/)   
  
Мы видим, что для того, чтобы прийти к хорошему сообщению оба флага должны быть равны **1**.  
  
Это упражнение имеет много решений, потому что структура **JUAN** находится выше в стеке.  
  
![33.png](https://wasm.in/attachments/33-png.2290/)   
  
Выполняя функции **GET\_S** мы можем перезаписать все флаги так, чтобы они остались равны **1** и таки образом, сделать это одним переполнением. Также это можно сделать индивидуально, перезаписывая в каждой функции **GET\_S** флаг и нет необходимости перезаписывать поле **COOKIE** правильным значением, потому что мы напрямую перезаписываем флаг, не дожидаясь сравнения поля **COOKIE**, чтобы изменить его.  
  
Чтобы перезаписать флаг, у меня есть **16** десятичных байт, плюс к этому значению **3** **DWORD** или это будет **12** байт.  
  
Общая сумма байт будет равна: **16** + **12** = **28** байт.  
  
![34.png](https://wasm.in/attachments/34-png.2291/)   
  
Поэтому количество фруктов будет равно: **FRUTA** = **28\*** “**A**” **+** “**\x01**”  
  
![35.png](https://wasm.in/attachments/35-png.2292/)   
  
Конечно, для каждой из структур Вы должны передать **-1** или отрицательное значение, которое пройдет проверку против числа **0x10**, а затем должен следовать фруктовый-шеллкод \)\).  
  
![36.png](https://wasm.in/attachments/36-png.2293/)   
  
Если мы немного поотлаживаем, мы увидим значение **-1**, которое помещается в поле **NUMERO** структуры **PEPE**.  
  
![37.png](https://wasm.in/attachments/37-png.2294/)   
  
![38.png](https://wasm.in/attachments/38-png.2295/)   
  
Программа проходит проверку и достигает функцию **GETS\_S**. Здесь и читаются переданные фрукты.  
  
![39.png](https://wasm.in/attachments/39-png.2296/)   
  
Здесь я вижу адрес структуры **PEPE** на моей машине, после исполнения функции **GET\_S**. Если я пойду в стек.  
  
![40.png](https://wasm.in/attachments/40-png.2297/)   
  
Здесь я вижу наши **ФРУКТЫ**, которые я посылаю программе. Если я хочу сконвертировать эти данные в структуру, то я нажимаю **ALT** **+** **Q**.  
  
![41.png](https://wasm.in/attachments/41-png.2298/)   
  
И выбираю пункт **MYSTRUCT**.  
  
![42.png](https://wasm.in/attachments/42-png.2299/)   
  
Я вижу, что поля и флаг уже перезаписан на значение 1 переполнением. Не исследуя подробно другие функции, я продолжаю трассировать.  
  
![43.png](https://wasm.in/attachments/43-png.2300/)   
  
Мы видим, что программа сравнивает **COOKIE** со значением **0x99989796** и поскольку это разные значения, программа не изменят флаг. Но флаг уже равен **1**, поэтому это не так важно.  
  
Тот же процесс будет повторяться и мы переходим в функцию **DECISION2**.  
  
![44.png](https://wasm.in/attachments/44-png.2301/)   
  
Я начинаю трассировать с помощью клавиши **F7**.  
  
![45.png](https://wasm.in/attachments/45-png.2302/)   
  
Регистр **EAX** имеет начало структуры **JUAN**. Давайте посмотрим на эту структуру в стеке.  
  
![46.png](https://wasm.in/attachments/46-png.2303/)   
  
Здесь, я также нажимаю сочетание **ALT** **+** **Q**, чтобы из байтов собрать структуру. Снова выбираем нашу структуру **MYSTRUCT**.  
  
![47.png](https://wasm.in/attachments/47-png.2304/)   
  
Так же как и раньше флаг будет равен **1**. Сравнение с **COOKIE** не будет равно, но программа продолжит выполняться, потому что с флагом уже всё хорошо.  
  
![48.png](https://wasm.in/attachments/48-png.2305/)   
  
Поле **PEPE.FLAG** равно **1** и это хорошо, поэтому продолжаем трассировку.  
  
![49.png](https://wasm.in/attachments/49-png.2306/)   
  
Поле **JUAN**.**FLAG** также правильное, поэтому я достигаю хорошего сообщения.  
  
![50.png](https://wasm.in/attachments/50-png.2307/)   
  
Готово. Теперь пример решен. Мы победили.  
Увидимся в **28** части.  
  
=====================================================  
Автор текста: **Рикардо Нарваха** - **Ricardo** **Narvaja** \(**@ricnar456**\)  
Перевод на английский: **IvinsonCLS \(@IvinsonCLS\)**  
Перевод на русский с испанского+английского: **Яша\_Добрый\_Хакер\(Ростовский фанат Нарвахи\).**  
Перевод специально для форума системного и низкоуровневого программирования — **WASM.IN  
05.01.2018  
Версия 1.0**

